<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Empire Casino Web</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #d4af37; --bg: #0f0f0f; --panel: #1a1a1a; --text: #ffffff; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –±–∞–ª–∞–Ω—Å–æ–º */
        .top-bar { padding: 15px; display: flex; justify-content: space-between; align-items: center; background: var(--panel); border-bottom: 1px solid #333; }
        .balance-box { background: #000; padding: 6px 15px; border-radius: 20px; border: 1px solid var(--gold); color: var(--gold); font-weight: bold; font-size: 1.1rem; }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ */
        .tab-content { flex: 1; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .tab-content.active { display: flex; }

        /* –ò–≥—Ä–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (–°–ª–æ—Ç—ã) */
        .reels { display: flex; gap: 10px; margin-bottom: 30px; }
        .reel { width: 80px; height: 100px; background: #000; border: 2px solid #333; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 3rem; box-shadow: 0 0 15px rgba(212, 175, 55, 0.1); }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn { background: var(--gold); color: #000; border: none; padding: 18px; border-radius: 15px; font-weight: bold; width: 100%; max-width: 280px; font-size: 1.1rem; text-transform: uppercase; transition: transform 0.1s; }
        .btn:active { transform: scale(0.96); }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-list { width: 100%; max-width: 320px; }
        .setting-item { display: flex; justify-content: space-between; align-items: center; padding: 18px 0; border-bottom: 1px solid #333; }
        select { background: #333; color: #fff; border: 1px solid var(--gold); padding: 8px; border-radius: 8px; font-size: 1rem; }
        input[type="checkbox"] { width: 22px; height: 22px; accent-color: var(--gold); }

        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        .bottom-nav { display: flex; background: var(--panel); border-top: 1px solid #333; padding: 12px 0; padding-bottom: 25px; }
        .nav-item { flex: 1; text-align: center; color: #777; font-size: 0.85rem; cursor: pointer; transition: 0.2s; }
        .nav-item.active { color: var(--gold); }
        .nav-icon { font-size: 1.6rem; display: block; margin-bottom: 4px; }
    </style>
</head>
<body>

    <div class="top-bar">
        <span id="label-app" style="font-weight: bold; letter-spacing: 1px;">EMPIRE APP</span>
        <div class="balance-box">üí∞ <span id="balance">0</span> ‚òÖ</div>
    </div>

    <div id="game-tab" class="tab-content active">
        <div class="reels">
            <div id="r1" class="reel">üíé</div>
            <div id="r2" class="reel">üíé</div>
            <div id="r3" class="reel">üíé</div>
        </div>
        <button class="btn" id="btn-spin" onclick="spin()">–ö–†–£–¢–ò–¢–¨</button>
        <p id="status" style="margin-top: 20px; color: #777;"></p>
    </div>

    <div id="settings-tab" class="tab-content">
        <h2 id="label-settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        <div class="settings-list">
            <div class="setting-item">
                <span id="label-lang">–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</span>
                <select id="langSelect" onchange="changeLang()">
                    <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                    <option value="en">English</option>
                </select>
            </div>
            <div class="setting-item">
                <span id="label-vibrate">–í–∏–±—Ä–∞—Ü–∏—è (Haptic)</span>
                <input type="checkbox" id="vibrateCheck" checked onchange="saveSettings()">
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" id="nav-game" onclick="showTab('game')">
            <span class="nav-icon">üéÆ</span> <span id="nav-label-game">–ò–≥—Ä–∞</span>
        </div>
        <div class="nav-item" id="nav-settings" onclick="showTab('settings')">
            <span class="nav-icon">‚öôÔ∏è</span> <span id="nav-label-settings">–û–ø—Ü–∏–∏</span>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        const langData = {
            ru: { app: "EMPIRE APP", game: "–ò–≥—Ä–∞", settings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏", lang: "–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞", vibrate: "–í–∏–±—Ä–∞—Ü–∏—è (Haptic)", spin: "–ö–†–£–¢–ò–¢–¨", status: "–ò—Å–ø—ã—Ç–∞–π —É–¥–∞—á—É!" },
            en: { app: "EMPIRE APP", game: "Game", settings: "Settings", lang: "Language", vibrate: "Haptic Feedback", spin: "SPIN", status: "Good luck!" }
        };

        // 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∏–∑ URL (–æ—Ç –±–æ—Ç–∞)
        function updateBalanceFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            const balanceFromUrl = urlParams.get('balance');
            if (balanceFromUrl !== null) {
                document.getElementById('balance').innerText = balanceFromUrl;
            }
        }

        // 2. –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
        function showTab(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(tab + '-tab').classList.add('active');
            document.getElementById('nav-' + tab).classList.add('active');
            
            // –õ–µ–≥–∫–∞—è –≤–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ —Å–º–µ–Ω–µ –≤–∫–ª–∞–¥–∫–∏
            if(document.getElementById('vibrateCheck').checked) tg.HapticFeedback.impactOccurred('light');
        }

        // 3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function saveSettings() {
            const settings = {
                lang: document.getElementById('langSelect').value,
                vibrate: document.getElementById('vibrateCheck').checked
            };
            localStorage.setItem('empire_settings', JSON.stringify(settings));
        }

        // 4. –°–º–µ–Ω–∞ —è–∑—ã–∫–∞
        function changeLang() {
            const lang = document.getElementById('langSelect').value;
            const d = langData[lang];
            document.getElementById('label-app').innerText = d.app;
            document.getElementById('nav-label-game').innerText = d.game;
            document.getElementById('nav-label-settings').innerText = d.settings;
            document.getElementById('label-settings').innerText = d.settings;
            document.getElementById('label-lang').innerText = d.lang;
            document.getElementById('label-vibrate').innerText = d.vibrate;
            document.getElementById('btn-spin').innerText = d.spin;
            document.getElementById('status').innerText = d.status;
            saveSettings();
        }

        // 5. –õ–æ–≥–∏–∫–∞ –≤—Ä–∞—â–µ–Ω–∏—è (–≤–∏–∑—É–∞–ª—å–Ω–∞—è)
        function spin() {
            const isVibrate = document.getElementById('vibrateCheck').checked;
            if(isVibrate) tg.HapticFeedback.impactOccurred('medium');
            
            const icons = ['üíé', 'üé∞', 'üåü', 'üçí', '7Ô∏è‚É£'];
            const r1 = icons[Math.floor(Math.random() * icons.length)];
            const r2 = icons[Math.floor(Math.random() * icons.length)];
            const r3 = icons[Math.floor(Math.random() * icons.length)];
            
            document.getElementById('r1').innerText = r1;
            document.getElementById('r2').innerText = r2;
            document.getElementById('r3').innerText = r3;

            if(r1 === r2 && r2 === r3) {
                if(isVibrate) tg.HapticFeedback.notificationOccurred('success');
                document.getElementById('status').innerText = "JACKPOT! üéâ";
            }
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        updateBalanceFromUrl();
        const saved = JSON.parse(localStorage.getItem('empire_settings'));
        if(saved) {
            document.getElementById('langSelect').value = saved.lang;
            document.getElementById('vibrateCheck').checked = saved.vibrate;
            changeLang();
        } else {
            document.getElementById('status').innerText = langData.ru.status;
        }
    </script>
</body>
</html>
