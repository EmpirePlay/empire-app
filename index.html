<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Empire Casino Web</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #d4af37; --bg: #0f0f0f; --panel: #1a1a1a; --text: #ffffff; }
        body { 
            background: var(--bg); color: var(--text); 
            font-family: 'Segoe UI', Roboto, sans-serif; 
            margin: 0; padding: 0; height: 100vh; 
            display: flex; flex-direction: column; overflow: hidden; 
        }
        
        /* –®–∞–ø–∫–∞ */
        .top-bar { padding: 15px; display: flex; justify-content: space-between; align-items: center; background: var(--panel); border-bottom: 1px solid #333; }
        .balance-box { background: #000; padding: 6px 15px; border-radius: 20px; border: 1px solid var(--gold); color: var(--gold); font-weight: bold; font-size: 1.1rem; }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .tab-content { flex: 1; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .tab-content.active { display: flex; }

        /* –°–ª–æ—Ç-–º–∞—à–∏–Ω–∞ */
        .reels { display: flex; gap: 10px; margin-bottom: 30px; }
        .reel { 
            width: 80px; height: 100px; background: #000; 
            border: 2px solid #333; border-radius: 12px; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 3rem; transition: transform 0.1s;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.1); 
        }
        
        /* –ö–Ω–æ–ø–∫–∞ */
        .btn { 
            background: var(--gold); color: #000; border: none; 
            padding: 18px; border-radius: 15px; font-weight: bold; 
            width: 100%; max-width: 280px; font-size: 1.1rem; 
            text-transform: uppercase; cursor: pointer;
        }
        .btn:disabled { background: #555; cursor: not-allowed; }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-list { width: 100%; max-width: 320px; }
        .setting-item { display: flex; justify-content: space-between; align-items: center; padding: 18px 0; border-bottom: 1px solid #333; }
        select { background: #333; color: #fff; border: 1px solid var(--gold); padding: 8px; border-radius: 8px; }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav { display: flex; background: var(--panel); border-top: 1px solid #333; padding: 12px 0 25px 0; }
        .nav-item { flex: 1; text-align: center; color: #777; font-size: 0.85rem; }
        .nav-item.active { color: var(--gold); }
        .nav-icon { font-size: 1.6rem; display: block; margin-bottom: 4px; }
    </style>
</head>
<body>

    <div class="top-bar">
        <span id="label-app" style="font-weight: bold; letter-spacing: 1px;">EMPIRE APP</span>
        <div class="balance-box">üí∞ <span id="balance">0</span> ‚òÖ</div>
    </div>

    <div id="game-tab" class="tab-content active">
        <div class="reels">
            <div id="r1" class="reel">üíé</div>
            <div id="r2" class="reel">üíé</div>
            <div id="r3" class="reel">üíé</div>
        </div>
        <button class="btn" id="btn-spin" onclick="spin()">–ö–†–£–¢–ò–¢–¨</button>
        <p id="status" style="margin-top: 20px; color: #777;">–£–¥–∞—á–∏!</p>
    </div>

    <div id="settings-tab" class="tab-content">
        <div class="settings-list">
            <div class="setting-item">
                <span id="label-lang">–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</span>
                <select id="langSelect" onchange="changeLang()">
                    <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                    <option value="en">English</option>
                </select>
            </div>
            <div class="setting-item">
                <span id="label-vibrate">–í–∏–±—Ä–∞—Ü–∏—è</span>
                <input type="checkbox" id="vibrateCheck" checked onchange="saveSettings()">
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" id="nav-game" onclick="showTab('game')">
            <span class="nav-icon">üéÆ</span> <span id="nav-label-game">–ò–≥—Ä–∞</span>
        </div>
        <div class="nav-item" id="nav-settings" onclick="showTab('settings')">
            <span class="nav-icon">‚öôÔ∏è</span> <span id="nav-label-settings">–û–ø—Ü–∏–∏</span>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        const icons = ['üíé', 'üé∞', 'üåü', 'üçí', '7Ô∏è‚É£'];

        // –°—á–∏—Ç—ã–≤–∞–µ–º –±–∞–ª–∞–Ω—Å –∏–∑ URL
        function updateBalanceFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            const balance = urlParams.get('balance');
            if (balance) document.getElementById('balance').innerText = balance;
        }

        function showTab(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(tab + '-tab').classList.add('active');
            document.getElementById('nav-' + tab).classList.add('active');
            if(document.getElementById('vibrateCheck').checked) tg.HapticFeedback.impactOccurred('light');
        }

        // –ö–†–ê–°–ò–í–ê–Ø –ü–†–û–ö–†–£–¢–ö–ê
        async function spin() {
            const btn = document.getElementById('btn-spin');
            const status = document.getElementById('status');
            const isVibrate = document.getElementById('vibrateCheck').checked;

            btn.disabled = true;
            status.innerText = "–í—Ä–∞—â–∞–µ–º...";

            // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
            for (let i = 0; i < 12; i++) {
                document.getElementById('r1').innerText = icons[Math.floor(Math.random() * icons.length)];
                document.getElementById('r2').innerText = icons[Math.floor(Math.random() * icons.length)];
                document.getElementById('r3').innerText = icons[Math.floor(Math.random() * icons.length)];
                
                if(isVibrate && i % 2 === 0) tg.HapticFeedback.impactOccurred('light');
                await new Promise(r => setTimeout(r, 100)); // –°–∫–æ—Ä–æ—Å—Ç—å —Å–º–µ–Ω—ã –∫–∞–¥—Ä–æ–≤
            }

            // –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            const res = [
                icons[Math.floor(Math.random() * icons.length)],
                icons[Math.floor(Math.random() * icons.length)],
                icons[Math.floor(Math.random() * icons.length)]
            ];

            document.getElementById('r1').innerText = res[0];
            document.getElementById('r2').innerText = res[1];
            document.getElementById('r3').innerText = res[2];

            if (res[0] === res[1] && res[1] === res[2]) {
                status.innerText = "–í–´–ò–ì–†–´–®! üéâ";
                if(isVibrate) tg.HapticFeedback.notificationOccurred('success');
            } else {
                status.innerText = "–ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞";
            }

            btn.disabled = false;
        }

        function saveSettings() {
            localStorage.setItem('empire_set', JSON.stringify({
                lang: document.getElementById('langSelect').value,
                vibrate: document.getElementById('vibrateCheck').checked
            }));
        }

        updateBalanceFromUrl();
    </script>
</body>
</html>
